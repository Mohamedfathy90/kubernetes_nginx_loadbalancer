server {
    listen 80;
    server_name _;
    return 301 https://$host:30443$request_uri;
}

upstream node_apps {
        server app1-service:3000;
        server app2-service:3000;
        }


server {

        listen 443 ssl;
        server_name _;

        root /var/www/html;

        ssl_certificate /etc/ssl/certs/localhost.pem;
        ssl_certificate_key /etc/ssl/certs/localhost-key.pem;

        # Add index.php to the list if you are using PHP
        index index.html index.htm index.nginx-debian.html;

        location / {
                proxy_pass http://node_apps;
                try_files $uri $uri/ =404;
        }

        location /devops/ {
        auth_basic "Restricted Area";
        auth_basic_user_file /etc/nginx/.htpasswd;
        alias /var/www/devops/;
        index index.html;
}


        }


